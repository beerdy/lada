<section class="slider">
  <div class="flexslider">
    <div class="flex-viewport">
      <ul class="slides">
        <% Slider.all.sort_by(&:sort).each do |slide|%>
        <li class="clone" aria-hidden="true" >
          <img src="<%=slide.image.url%>" draggable="false">
          <p class="flex-caption"><a href="/sliders/<%=slide.id%>" class="btn btn-danger btn-lg " style="border-radius:50px;font-size:100%; border: 2px solid orange">ПОДРОБНЕЕ <i class="fa fa-tags" aria-hidden="true"></i>
</a></p>
        </li>
        <%end%>
      </ul>
    </div>
  </div>
</section>

<section class="products">
    <div class="container">
      <div class="row">
        <% Product.all.sort_by(&:sort).each do |product| %>
        <div class="col-sm-4">
          <div class="caption-title">
            <h2><%=product.title%></h2>
          </div>
          <div class="caption-description">
            <h3><%=product.description%> <i class="fa fa-rub" aria-hidden="true"></i>*</h3>
          </div>
          <div class="caption-image">
            <%= image_tag  product.image.url, alt: product.title, class: 'img-responsive'%>
          </div>
          <a href="tel:84742<%=@phone.tr(' ', '')%>" style='color: white'>
          <div class="caption-button">
            <h3>ЗВОНИТЕ</h3>
            <h3>(4742) <%=@phone%></h3>
          </div>
          </a>
        </div>
        <%end%>
        <div class="col-sm-4 static-col">
          <div class="caption-description text-center">
            <%= @buttons.slave.html_safe%>
          </div>
          <div  class="caption-image text-center">
            <%= @buttons.description.html_safe%>
          </div>
          <a href="tel:84742565071" style="color: white">
          <div class="caption-button">
            <h3>ЗВОНИТЕ</h3>
            <h3>(4742) 565 071</h3>
          </div>
          </a>
        </div>
      </div>  
    </div>
    <br><br><br>
    <script type="text/javascript">
      $(document).on('turbolinks:load',function() {

        var delayResize, resizeElements, resizeOnMainPage;
        

        resizeOnMainPage = function(captured,wrap) { // source, distanse
          var heights=[], maxHeight;
          $(captured).each(function() {
            heights.push($(this).height());
          });
          maxHeight = Math.max.apply(null, heights);
          $(wrap).height(maxHeight);
        };

        delayResize = function(func) {
          var timer;
          timer = void 0;
          return function(event) {
            if (timer) {
              clearTimeout(timer);
            }
            timer = setTimeout(func, 1000, event);
          };
        };

        //resize when load
        setTimeout(function() {
          resizeOnMainPage('.col-sm-4','.col-sm-4');
        }, 1000);

        //resize when resize window
        return window.addEventListener('resize', delayResize(resizeElements = function(e) {
          resizeOnMainPage('.col-sm-4','.col-sm-4');
          return false;
        }));

      });
    </script>
</section>